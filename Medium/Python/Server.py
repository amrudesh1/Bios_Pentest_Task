from multiprocessing.connection import Listener

if __name__ == '__main__':
    address = ('localhost', 6000)  # family is deduced to be 'AF_INET'
    listener = Listener(address, authkey=str.encode('secret password'))
    conn = listener.accept()
    print('connection accepted from', listener.last_accepted)
    while True:
        msg = conn.recv()
        if str(msg):
            print(msg)
        try:
            message = str(input())
            if str(message):
                conn.send(message)

        except KeyboardInterrupt:
            conn.close()
            listener.close()
